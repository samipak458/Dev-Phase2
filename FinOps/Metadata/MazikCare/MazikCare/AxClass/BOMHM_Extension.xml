<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>BOMHM_Extension</Name>
	<SourceCode>
		<Declaration><![CDATA[
public static class BOMHM_Extension
{
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>bomCombinationExist</Name>
				<Source><![CDATA[
    public static boolean bomCombinationExist(BOM _this ,boolean _insertUpdate = true)
    {
        BOMVersion  BOMVersion, BomVersionOrig;
        BOM         BOM;
        Map         map;
        int         itemCount,validateCount,totalCount = 0;
        Args        args;

        map = new map(Types::String,Types::String);
        if(_insertUpdate)
        {
            map.insert(_this.ItemId,_this.ItemId);
            itemCount++;
        }

        while select BOMId,ItemId from BOM
        where BOM.BOMId == _this.BOMId
        && BOM.ItemId != _this.ItemId
        {
            map.insert(BOM.ItemId,BOM.ItemId);
            itemCount++;
        }


        while select BOMId,ItemId from BOMVersion
        where BOMVersion.BOMId != _this.BOMId
        {
            validateCount = 0;
            totalCount = 0;

            while select BOMId,ItemId from BOM
            where BOM.BOMId == BOMVersion.BOMId
            {
                totalCount++;
                if(map.exists(BOM.ItemId))
                {
                    validateCount++;
                }
            }
            if(itemcount > 0 && totalCount > 0)
            {
                if(itemcount == validateCount && itemCount == totalCount)
                {
                    select BOMId,ItemId from BomVersionOrig
                where BomVersionOrig.BOMId == _this.BOMId;

                    if(Box::yesNo(strFmt("@MAZ12064",BOMVersion.ItemId, BomVersionOrig.ItemId), DialogButton::Yes) == DialogButton::Yes)
                    {
                        args = new args();
                        args.record(BomVersionOrig);
                        new MenuFunction(menuitemDisplayStr(HMAppointmentViewTmp_ByProtocol),MenuItemType::Display).run(args);
                    }
                    return true;
                }
            }
        }
        return false;
    }

]]></Source>
			</Method>
			<Method>
				<Name>showExamName</Name>
				<Source><![CDATA[
   public static  display EcoResProductName showExamName(BOM _this)
    {

        return InventTable::find(_this.ItemId).itemDescriptionOrName();
    }

]]></Source>
			</Method>
			<Method>
				<Name>showInstruction</Name>
				<Source><![CDATA[
   public static display  Description showInstruction(BOM _this)
    {
        return HMInventTable::findByItemId(_this.ItemId).Instruction;
    }

]]></Source>
			</Method>
			<Method>
				<Name>showAmount</Name>
				<Source><![CDATA[
    public static display String50 showAmount(BOM _this)
    {
        BOM BOMLocal;
        select sum(Price) from  BOMLocal
                    where BOMLocal.BOMId == _this.BomId;
        
        return   strFmt(SysLabel::labelId2String2('@MAZ11062'), _this.BomId == '' ? 0.00: BOMLocal.Price);    
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>