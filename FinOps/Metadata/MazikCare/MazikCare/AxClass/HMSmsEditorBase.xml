<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>HMSmsEditorBase</Name>
	<SourceCode>
		<Declaration><![CDATA[
abstract class HMSmsEditorBase extends SysInetHTMLEditor
{
    SysEmailId id;
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>canClose</Name>
				<Source><![CDATA[
    public boolean canClose()
    {
        this.save();
        return true;
    }

]]></Source>
			</Method>
			<Method>
				<Name>caption</Name>
				<Source><![CDATA[
    abstract str caption()
    {
    }

]]></Source>
			</Method>
			<Method>
				<Name>init</Name>
				<Source><![CDATA[
    void init()
    {
        super();
    
        formRun.updateTheme('');
    }

]]></Source>
			</Method>
			<Method>
				<Name>isToolEnabled</Name>
				<Source><![CDATA[
    boolean isToolEnabled(int commandId, int tab)
    {
        switch (tab)
        {
            case #TABSource:
                switch (commandId)
                {
                    case #TOOL_SAVE:
                        return true;
                }
                return false;
    
            case #TABPreview:
                return false;
    
            case #TABNormal:
                switch (commandId)
                {
                    case #TOOL_SAVEAS:
                    case #TOOL_NEW:
                    case #TOOL_OPEN:
                    case #TOOL_MENU_ELEMENT:
    
                    case #TOOL_MAKEABSOLUTE:
                    case #TOOL_BRINGTOFRONT:
                    case #TOOL_SENDTOBACK:
                    case #TOOL_BRINGFORWARD:
                    case #TOOL_SENDBACKWARD:
                    case #TOOL_BRINGABOVETEXT:
                    case #TOOL_SENDBELOWTEXT:
                    case #TOOL_LOCKELEMENT:
    
                    case #TOOL_INSERTWEBPART:
                    case #TOOL_INSERTACTIVEX:
                    case #TOOL_INSERTWEBLET:
                    case #TOOL_INSERTAXAPTAMENU:
                    case #TOOL_THEME:
                        return false;
    
    
                    case #TOOL_INSERTBOOKMARKLINK:
                    case #TOOL_INSERTHELPLINKMENU:
                    case #TOOL_INSERTFORMRUNLINK:
                    case #TOOL_INSERTEXTHELPLINK:
                    case #TOOL_INSERTFIELDLINK:
                    case #TOOL_INSERTMENUDISPLAYLINK:
                    case #TOOL_INSERTMENUOUTPUTLINK:
                    case #TOOL_INSERTMENUACTIONLINK:
                    case #TOOL_INSERTCLASSLINK:
                    case #TOOL_INSERTMETHODLINK:
                    case #TOOL_INSERTFUNCTIONLINK:
                    case #TOOL_INSERTPROPERTYLINK:
                    case #TOOL_INSERTHELPTITLE:
                    case #TOOL_INSERTIFRAME:
                        return false;
                }
        }
        return true;
    }

]]></Source>
			</Method>
			<Method>
				<Name>new</Name>
				<Source><![CDATA[
    void new(SysEmailId _id, LanguageId _languageId)
    {
    ;
        id = _id;
        _language = _languageId;
    
        super();
    }

]]></Source>
			</Method>
			<Method>
				<Name>runTool</Name>
				<Source><![CDATA[
    public boolean runTool(int commandId, int tab)
    {
        switch(commandId)
        {
            case #TOOL_SAVE:
                this.save();
                formRun.documentChanged(false);
                formRun.refreshHTMLControl();
                return true;
            case #TOOL_EDITORHELP:
                sysHelp::showURL(SysHelpPath::applClass(classstr(HMSmsEditor)));
                return true;
        }
    
        return false;
    }

]]></Source>
			</Method>
			<Method>
				<Name>save</Name>
				<Source><![CDATA[
    abstract void save()
    {
    }

]]></Source>
			</Method>
			<Method>
				<Name>setText</Name>
				<Source><![CDATA[
    void setText(str s)
    {
        initialText = s;
    }

]]></Source>
			</Method>
			<Method>
				<Name>text</Name>
				<Source><![CDATA[
    str text(str text = '')
    {
        int i;
    ;
        if (prmisdefault(text))
            return super();
    
        i = strscan(text, '<body', 1, strlen(text));
        if (i)
        {
            text = strdel(text, i, strscan(text, '>', i, strlen(text))-i+1);
        }
    
        return super(text);
    }

]]></Source>
			</Method>
			<Method>
				<Name>main</Name>
				<Source><![CDATA[
    static void main(Args args)
    {
        SysEmailMessageMap  message = args.record();
    
        HMSmsEditor e = new HMSmsEditor(message.eMailId, message.LanguageId);
        e.run();
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>