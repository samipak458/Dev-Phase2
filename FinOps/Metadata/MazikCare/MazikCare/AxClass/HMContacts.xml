<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>HMContacts</Name>
	<SourceCode>
		<Declaration><![CDATA[
class HMContacts
{
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>main</Name>
				<Source><![CDATA[
    /// <summary>
    ///    Called by the menu items.
    /// </summary>
    /// <param name="_args">
    ///    The <c>Args</c> object passed from the menu item.
    /// </param>
    public static void main(Args _args)
    {
        LogisticsElectronicAddress partyContactInfo;
    
        FormRun         callerFormRun,formRun;
        Object          formRunObject;
        FormObjectSet   formObjectSet;
        Common          callerRecord;
    
        // Verify context
        if (_args.record() == null || _args.record().TableId != tablenum(LogisticsElectronicAddress))
        {
            // Class %1 must be called with buffer %2.
            throw error(strfmt("@SYS113735", classstr(DirPartyContactInfoAction), tablestr(LogisticsElectronicAddress)));
        }
    
        formObjectSet = FormDataUtil::getFormDataSource(_args.record());
        if (formObjectSet)
        {
            callerFormRun = formObjectSet.formRun();
            if (_args.parm() == 'InPatient')
            {
                formObjectSet = callerFormRun.dataSource('CustTable');
            }
            else if (_args.parm() == 'Organization')
            {
                formObjectSet = callerFormRun.dataSource('DirOrganization');
            }
            callerRecord = formObjectSet.cursor();
        }
    
        partyContactInfo = _args.record();
        //partyContactInfo.deactivate(callerRecord);
        partyContactInfo.delete();
    
        if (_args.parm() == 'InPatient')
        {
            formRun = _args.caller().owner();
            if(formHasMethod(formRun,identifierstr(refreshContactsGrid)))
            {
                formRunObject = formRun;
                formRunObject.refreshContactsGrid();
            }
    
        }
    
      /*  if (_args.parmEnumType() == enumnum(LogisticsLocationAddressActionButtons))
        {
            switch (_args.parmEnum())
            {
                case LogisticsLocationAddressActionButtons::Deactivate :
                    // Deactivate
                    partyContactInfo.deactivate(callerRecord);
                    break;
            }
        }  */
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>