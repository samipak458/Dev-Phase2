<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>HMResourceConsultationInquiry</Name>
	<SourceCode>
		<Declaration><![CDATA[
class HMResourceConsultationInquiry
{
    HMResourceConsultationTmp hmResourceConsultationTmp;
    ItemGroupId             consultationItemGroup;
    ItemId                  freeFollowupService;
    MonthsOfYear            month;
    YearBase                yearValue;
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>getDayWiseCount</Name>
				<Source><![CDATA[
    private Counter getDayWiseCount(RecId _resourceRecid, Day _day)
    {
        HMResourceSchedulingAppointment         hmResourceSchedulingAppointment;
        HMResourceSchedulingPlanningObject      hmResourceSchedulingPlanningObject;
        HMCaseTrans                             hmCaseTrans;
        InventItemGroupItem                     inventItemGroupItem;
        int day;
        date _date = mkDate(_day, month, yearValue);
        day = dayOfMth(_date);
        if(day == _day)
        {
            select count(RecId) from hmResourceSchedulingAppointment
                where hmResourceSchedulingAppointment.AppointmentDate == mkDate(_day, month, yearValue)
                exists join hmResourceSchedulingPlanningObject
                    where hmResourceSchedulingPlanningObject.RecId == hmResourceSchedulingAppointment.HMResourceSchedulingPlanningObject
                    && hmResourceSchedulingPlanningObject.HMResourceMaster == _resourceRecid
                exists join hmCaseTrans
                    where hmCaseTrans.HMResourceSchedulingAppointment == hmResourceSchedulingAppointment.RecId
                    && hmCaseTrans.HMServiceStatus == HMServiceStatus::Complete
                    && hmCaseTrans.ItemId !=  freeFollowupService
                exists join inventItemGroupItem where inventItemGroupItem.ItemId == hmCaseTrans.ItemId
                && inventItemGroupItem.ItemDataAreaId == hmCaseTrans.dataAreaId
                && inventItemGroupItem.ItemGroupDataAreaId == hmCaseTrans.dataAreaId
                && inventItemGroupItem.ItemGroupId == consultationItemGroup;
    
            return int642int(hmResourceSchedulingAppointment.RecId);
        }
        else
        {
            return 0;
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>getHMResourceConsultationTmp</Name>
				<Source><![CDATA[
    public HMResourceConsultationTmp getHMResourceConsultationTmp()
    {
        return hmResourceConsultationTmp;
    }

]]></Source>
			</Method>
			<Method>
				<Name>processReport</Name>
				<Source><![CDATA[
    public void processReport(MonthsOfYear _month, YearBase _year)
    {
        HMResourceMaster        hmResourceMaster;
        HMClinicStaffRole       hmClinicStaffRole;
        HMBillParameters hmBillParameters = HMBillParameters::find();
    
        consultationItemGroup = hmBillParameters.ConsultationItemGroup;
        month = _month;
        yearValue = _year;
        freeFollowupService = hmBillParameters.FreeFollowUpService;
    
        while select Code,Description, RecId from hmResourceMaster
            exists join hmClinicStaffRole
                where hmClinicStaffRole.RecId == hmResourceMaster.HMClinicStaffRole
                && hmClinicStaffRole.Role == HMStaffMemberType::Physician
        {
            hmResourceConsultationTmp.clear();
    
            hmResourceConsultationTmp.ResourceCode = hmResourceMaster.Code;
            hmResourceConsultationTmp.ResourceDescription = hmResourceMaster.Description;
            hmResourceConsultationTmp.Day1 = this.getDayWiseCount(hmResourceMaster.RecId, 1);
            hmResourceConsultationTmp.Day2 = this.getDayWiseCount(hmResourceMaster.RecId, 2);
            hmResourceConsultationTmp.Day3 = this.getDayWiseCount(hmResourceMaster.RecId, 3);
            hmResourceConsultationTmp.Day4 = this.getDayWiseCount(hmResourceMaster.RecId, 4);
            hmResourceConsultationTmp.Day5 = this.getDayWiseCount(hmResourceMaster.RecId, 5);
            hmResourceConsultationTmp.Day6 = this.getDayWiseCount(hmResourceMaster.RecId, 6);
            hmResourceConsultationTmp.Day7 = this.getDayWiseCount(hmResourceMaster.RecId, 7);
            hmResourceConsultationTmp.Day8 = this.getDayWiseCount(hmResourceMaster.RecId, 8);
            hmResourceConsultationTmp.Day9 = this.getDayWiseCount(hmResourceMaster.RecId, 9);
            hmResourceConsultationTmp.Day10 = this.getDayWiseCount(hmResourceMaster.RecId, 10);
            hmResourceConsultationTmp.Day11 = this.getDayWiseCount(hmResourceMaster.RecId, 11);
            hmResourceConsultationTmp.Day12 = this.getDayWiseCount(hmResourceMaster.RecId, 12);
            hmResourceConsultationTmp.Day13 = this.getDayWiseCount(hmResourceMaster.RecId, 13);
            hmResourceConsultationTmp.Day14 = this.getDayWiseCount(hmResourceMaster.RecId, 14);
            hmResourceConsultationTmp.Day15 = this.getDayWiseCount(hmResourceMaster.RecId, 15);
            hmResourceConsultationTmp.Day16 = this.getDayWiseCount(hmResourceMaster.RecId, 16);
            hmResourceConsultationTmp.Day17 = this.getDayWiseCount(hmResourceMaster.RecId, 17);
            hmResourceConsultationTmp.Day18 = this.getDayWiseCount(hmResourceMaster.RecId, 18);
            hmResourceConsultationTmp.Day19 = this.getDayWiseCount(hmResourceMaster.RecId, 19);
            hmResourceConsultationTmp.Day20 = this.getDayWiseCount(hmResourceMaster.RecId, 20);
            hmResourceConsultationTmp.Day21 = this.getDayWiseCount(hmResourceMaster.RecId, 21);
            hmResourceConsultationTmp.Day22 = this.getDayWiseCount(hmResourceMaster.RecId, 22);
            hmResourceConsultationTmp.Day23 = this.getDayWiseCount(hmResourceMaster.RecId, 23);
            hmResourceConsultationTmp.Day24 = this.getDayWiseCount(hmResourceMaster.RecId, 24);
            hmResourceConsultationTmp.Day25 = this.getDayWiseCount(hmResourceMaster.RecId, 25);
            hmResourceConsultationTmp.Day26 = this.getDayWiseCount(hmResourceMaster.RecId, 26);
            hmResourceConsultationTmp.Day27 = this.getDayWiseCount(hmResourceMaster.RecId, 27);
            hmResourceConsultationTmp.Day28 = this.getDayWiseCount(hmResourceMaster.RecId, 28);
            hmResourceConsultationTmp.Day29 = this.getDayWiseCount(hmResourceMaster.RecId, 29);
            hmResourceConsultationTmp.Day30 = this.getDayWiseCount(hmResourceMaster.RecId, 30);
            hmResourceConsultationTmp.Day31 = this.getDayWiseCount(hmResourceMaster.RecId, 31);
    
            hmResourceConsultationTmp.insert();
        }
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>