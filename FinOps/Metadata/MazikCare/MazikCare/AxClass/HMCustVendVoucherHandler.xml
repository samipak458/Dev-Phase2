<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>HMCustVendVoucherHandler</Name>
	<SourceCode>
		<Declaration><![CDATA[
class HMCustVendVoucherHandler
{
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>CustVoucher_Post_post</Name>
				<Source><![CDATA[
/*
    /// <summary>
    ///
    /// </summary>
    /// <param name="args"></param>
    [PostHandlerFor(classStr(CustVendVoucher), methodStr(CustVendVoucher, post))]
    public static void CustVendVoucher_Post_post(XppPrePostArgs args)
    {
        CustTransIdRef  custTransId;
        CustTrans       custTrans, custTransUpdate;
        CustInvoiceJour custInvJour;
        CustVendTrans _custVendTrans = args.getArg("_custVendTrans");

        custTrans = _custVendTrans;

        select * from custTransId
            where custTransId.TransRecId == custTrans.RecId;

        if(custTransId)
        {
            select * from custInvJour
                where custInvJour.InvoiceId == custTransId.TransRefId;

            if(custInvJour)
            {
                select forupdate custTransUpdate
                    where custTransUpdate.RecId == custTrans.RecId;

                if(custTransUpdate)
                {
                    ttsbegin;
                    custTransUpdate.HMCase = custInvJour.HMCase;
                    custTransUpdate.doUpdate();
                    ttscommit;
                }


            }
        }
    }
    */
    /// <summary>
    ///
    /// </summary>
    /// <param name="args"></param>
    [PostHandlerFor(classStr(CustVoucher), methodStr(CustVoucher, post))]
    public static void CustVoucher_Post_post(XppPrePostArgs args)
    {
        CustVoucher     _custvoucher =args.getThis();
        CustTransIdRef  custTransId;
        CustTrans       custTrans, custTransUpdate;
        CustInvoiceJour custInvJour;
        CustVendTrans _custVendTrans = args.getArg("_custTrans");
        LedgerJournalTrans _LedgerJournalTrans;
        InvoiceId _inv;
        Voucher _voc;

        custTrans = _custVendTrans;
        /*
   
        select *from _LedgerJournalTrans 
            where _LedgerJournalTrans.CustTransId == custtrans.recid &&
            _LedgerJournalTrans.Voucher == custTrans.Voucher;
        if(_LedgerJournalTrans)
        {
            select forupdate custTransUpdate
                where custTransUpdate.RecId == custtrans.RecId;
            if(custTransUpdate)
            {
                ttsbegin;
                custTransUpdate.HMCase = _LedgerJournalTrans.HMCase;
                custTransUpdate.update();
                ttscommit;
            }
        }

        */

      /*
      
        _voc = _custVendTrans.Voucher;
        _inv =_custVendTrans.Invoice;
        info(_voc+" " + _inv);

        select  * from custInvJour where 
            custInvJour.LedgerVoucher == custTrans.Voucher ;//&&
           /* custInvJour.InvoiceAccount == custtrans.AccountNum &&
            custInvJour.LedgerVoucher == custTrans.Voucher &&
            custInvJour.InvoiceDate == custtrans.TransDate;*/

        if(custInvJour)
        {
            select forupdate custTransUpdate 
                where custTransUpdate.RecId == custtrans.RecId;
            if(custTransUpdate)
            {
                ttsbegin;
                custTransUpdate.HMCase = custInvJour.HMCase;
                custTransUpdate.update();
                ttscommit;
            }

        }
        */
       
        select * from custTransId
            where custTransId.TransRecId == custTrans.RecId;

        if(custTransId)
        {
            select * from custInvJour
                where custInvJour.InvoiceId == custTransId.TransRefId;

            if(custInvJour)
            {
                select forupdate custTransUpdate
                    where custTransUpdate.RecId == custTrans.RecId;

                if(custTransUpdate)
                {
                    ttsbegin;
                    custTransUpdate.HMCase = custInvJour.HMCase;
                    custTransUpdate.update();
                    ttscommit;
                }


            }
        }
        
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>