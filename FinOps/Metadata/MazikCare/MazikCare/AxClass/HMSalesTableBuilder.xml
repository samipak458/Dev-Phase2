<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>HMSalesTableBuilder</Name>
	<SourceCode>
		<Declaration><![CDATA[
class HMSalesTableBuilder
{
    SalesTable salesTable;
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>insert</Name>
				<Source><![CDATA[
    public void insert()
    {
        HMParameters hmParameters = HMParameters::find();
    
        if(CustTable::find(salesTable.CustAccount).PaymMode == '')
        {
            salesTable.PaymMode = hmParameters.CustPaymModeTable;
        }
        else
        {
            salesTable.PaymMode = CustTable::find(salesTable.CustAccount).PaymMode;
        }
        salesTable.InventSiteId = hmParameters.defaultInventSiteId;
        salesTable.InventLocationId = hmParameters.defaultInventLocationId;
        salesTable.insert();
    }

]]></Source>
			</Method>
			<Method>
				<Name>new</Name>
				<Source><![CDATA[
    public void new()
    {
        salesTable.SalesId = NumberSeq::newGetNum(SalesParameters::numRefSalesId()).num();
        salesTable.initValue();
        salesTable.SalesStatus = SalesStatus::Backorder;
    }

]]></Source>
			</Method>
			<Method>
				<Name>salesTable</Name>
				<Source><![CDATA[
    public SalesTable salesTable()
    {
        return salesTable;
    }

]]></Source>
			</Method>
			<Method>
				<Name>setAppointmentNumber</Name>
				<Source><![CDATA[
    public void setAppointmentNumber(HMAppointmentNumber _appointmentNumber)
    {
        salesTable.HMAppointmentNumber = _appointmentNumber;
    }

]]></Source>
			</Method>
			<Method>
				<Name>setBillingNotes</Name>
				<Source><![CDATA[
    public void setBillingNotes(str _billingNotes)
    {
        salesTable.BillingNotes = _billingNotes;
    }

]]></Source>
			</Method>
			<Method>
				<Name>setClientBillingType</Name>
				<Source><![CDATA[
    public void setClientBillingType(HMClientBillingType _clientBillingType)
    {
        salesTable.ClientBillingType = _clientBillingType;
        salesTable.modifiedField(fieldNum(SalesTable, ClientBillingType));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setCustAccount</Name>
				<Source><![CDATA[
    public void setCustAccount(CustAccount _custAccount)
    {
        SalesParameters salesParameters;
        boolean promptTransferOldValue;
    
        // Disable the nasty "Do you want to transfer customer information dialog"
        salesParameters = SalesParameters::find(true);
        promptTransferOldValue = salesParameters.PromptTransfer;
        salesParameters.PromptTransfer = false;
        salesParameters.update();
    
        salesTable.CustAccount = _custAccount;
        salesTable.modifiedField(fieldNum(SalesTable, CustAccount));
    
        // Revert the changes done to the SalesParameters
        salesParameters.PromptTransfer = promptTransferOldValue;
        salesParameters.update();
    }

]]></Source>
			</Method>
			<Method>
				<Name>setDeliveryAddress</Name>
				<Source><![CDATA[
    public void setDeliveryAddress(RecId _deliveryAddress)
    {
        salesTable.DeliveryPostalAddress = _deliveryAddress;
        salesTable.modifiedField(fieldNum(SalesTable, DeliveryPostalAddress));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setEmail</Name>
				<Source><![CDATA[
    public void setEmail(Email _email)
    {
        salesTable.Email = _email;
        salesTable.modifiedField(fieldNum(SalesTable, Email));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setInventDim</Name>
				<Source><![CDATA[
    public void setInventDim(InventLocationId _inventLocationId)
    {
        salesTable.InventLocationId = _inventLocationId;
        salesTable.modifiedField(fieldNum(SalesTable, InventLocationId));
        salesTable.InventSiteId = InventLocation::find(salesTable.InventLocationId).InventSiteId;
        salesTable.modifiedField(fieldNum(SalesTable, InventSiteId));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setInvoiceAccount</Name>
				<Source><![CDATA[
    public void setInvoiceAccount(CustAccount _custAccount)
    {
        salesTable.InvoiceAccount = _custAccount;
        salesTable.modifiedField(fieldNum(SalesTable, InvoiceAccount));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setInvoiceDate</Name>
				<Source><![CDATA[
    public void setInvoiceDate(Date _invoiceDate)
    {
        salesTable.InvoiceDate = _invoiceDate;
        salesTable.modifiedField(fieldNum(SalesTable, InvoiceDate));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setTaxGroup</Name>
				<Source><![CDATA[
    public void setTaxGroup(TaxGroup _taxGroup)
    {
        salesTable.TaxGroup = _taxGroup;
        salesTable.modifiedField(fieldNum(SalesTable, TaxGroup));
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>