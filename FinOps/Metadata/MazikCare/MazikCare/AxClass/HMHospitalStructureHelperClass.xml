<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>HMHospitalStructureHelperClass</Name>
	<SourceCode>
		<Declaration><![CDATA[
public class HMHospitalStructureHelperClass
{
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>getWards</Name>
				<Source><![CDATA[
    public static server Description255 getWards(RecId _hmBuildingUnitRecId)
    {
        Description255 wards;
        HMOrganizationalBuildingUnit    hmOrganizationalBuildingUnitLocal;
        HMOrganizationalUnit            hmOrganizationalUnitLocal;
    
        while select * from hmOrganizationalBuildingUnitLocal
            where hmOrganizationalBuildingUnitLocal.HMBuildingUnit == _hmBuildingUnitRecId
            join Description from hmOrganizationalUnitLocal
                where hmOrganizationalUnitLocal.RecId == hmOrganizationalBuildingUnitLocal.HMOrganizationalUnit
        {
            if(wards == '')
            {
                wards = hmOrganizationalUnitLocal.Description;
            }
            else
            {
                wards += ', ' + hmOrganizationalUnitLocal.Description;
            }
        }
    
        return wards;
    }

]]></Source>
			</Method>
			<Method>
				<Name>hasChildren</Name>
				<Source><![CDATA[
    public static server boolean hasChildren(RecId _buildingUnitRecId)
    {
        boolean ret = false;
        HMBuildingUnit      HMBuildingUnitCheckChild;
    
        while select RecId from HMBuildingUnitCheckChild
                where HMBuildingUnitCheckChild.HMBuildingUnit == _buildingUnitRecId
        {
            if (HMBuildingUnitCheckChild.RecId)
            {
                ret = true;
                break;
            }
        }
        return ret;
    }

]]></Source>
			</Method>
			<Method>
				<Name>updateGenderOccupancy</Name>
				<Source><![CDATA[
    public static server void updateGenderOccupancy(RecId _hmbuilduingUnit,boolean _isGender, HCMPersonGender _gender, boolean _update)
    {
        HMBuildingUnit                  hmBuildingUnitChild;
    
        ttsBegin;
    
        while select forUpdate hmBuildingUnitChild
            where hmBuildingUnitChild.HMBuildingUnit == _hmbuilduingUnit
        {
            if(!_update && (_isGender && hmBuildingUnitChild.IsGender == NoYes::Yes))
            {
                info(strFmt("@MAZ8215",hmBuildingUnitChild.Description));
            }
            else
            {
                hmBuildingUnitChild.IsGender = _isGender;
                hmBuildingUnitChild.Gender = _gender;
                if(hmBuildingUnitChild.validateWrite())
                {
                    hmBuildingUnitChild.update();
                    info(strFmt("@MAZ8216",hmBuildingUnitChild.Description));
                }
            }
        }
    
        ttsCommit;
    }

]]></Source>
			</Method>
			<Method>
				<Name>updateGenderOccupancyByOU</Name>
				<Source><![CDATA[
    public static server void updateGenderOccupancyByOU(RecId _hmorganizationalUnitRecid,boolean _isGender, HCMPersonGender _gender, boolean _update)
    {
        HMOrganizationalBuildingUnit    hmOrganizationalBuildingUnitLocal;
        HMBuildingUnit                  hmBuildingUnitLocal;
    
        ttsBegin;
    
        while select * from hmOrganizationalBuildingUnitLocal
            where hmOrganizationalBuildingUnitLocal.HMOrganizationalUnit == _hmorganizationalUnitRecid
            join forUpdate * from hmBuildingUnitLocal
                where hmBuildingUnitLocal.RecId == hmOrganizationalBuildingUnitLocal.HMBuildingUnit
        {
            if(!_update && (_isGender && hmBuildingUnitLocal.IsGender == NoYes::Yes))
            {
                info(strFmt("@MAZ8215",hmBuildingUnitLocal.Description));
            }
            else
            {
                hmBuildingUnitLocal.IsGender = _isGender;
                hmBuildingUnitLocal.Gender = _gender;
                if(hmBuildingUnitLocal.validateWrite())
                {
                    hmBuildingUnitLocal.update();
                    info(strFmt("@MAZ8216",hmBuildingUnitLocal.Description));
                }
            }
    
            HMBuildingUnit::updateGenderOccupancy(hmBuildingUnitLocal.RecId, _isGender, _gender,_update);
        }
    
        ttsCommit;
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>