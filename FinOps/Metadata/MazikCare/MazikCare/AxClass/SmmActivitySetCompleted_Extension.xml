<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>SmmActivitySetCompleted_Extension</Name>
	<SourceCode>
		<Declaration><![CDATA[
Public static class SmmActivitySetCompleted_Extension
{
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>smmActivitySetCompleted_Post_main</Name>
				<Source><![CDATA[
    /// <summary>
    ///
    /// </summary>
    /// <param name="args"></param>
    [PostHandlerFor(classStr(smmActivitySetCompleted), staticMethodStr(smmActivitySetCompleted, main))]
    public static void smmActivitySetCompleted_Post_main(XppPrePostArgs args)
    {
        smmActivities            smmActivities;
        FormRun                     formRun;
        HMActivitySubStatus         activitySubStatus;
        Args _args = args.getThis();
        //<Mazik>
        smmActivities = _args.record();
        formRun = _args.caller();
        if(formRun)
        {
            if(formHasMethod(FormRun,identifierStr(getActivitySubStatus)))
            {
                activitySubStatus = _args.caller().getActivitySubStatus();
            }
        }
        smmActivities = smmActivities::find(smmActivities.ActivityNumber);
        if(smmActivities.RecId)
        {
            ttsbegin;
            //<Mazik>
            smmActivities.HMActivitySubStatus = activitySubStatus;
            if(_args.parm() == 'Email')
            {
                smmActivities.HMActivitySubStatus = HMActivitySubStatus::AutoEmail;
            }
            //</Mazik>
            if (smmActivities.Category == smmActivityCategory::Task)
            {
                //</MazikCare>
                if(formRun)
                {
                    if(formHasMethod(FormRun,identifierStr(getsmmActivityTaskTimeType)))
                    {
                        smmActivities.ActivityTaskTimeType = _args.caller().getsmmActivityTaskTimeType();
                        if(smmActivities.ActivityTaskTimeType == smmActivityTaskTimeType::Completed)
                        {
                            smmActivities.PercentageCompleted  = 100;
                        }
                    }
                }
                else
                {
                    smmActivities.ActivityTaskTimeType = smmActivityTaskTimeType::Completed;
                    smmActivities.PercentageCompleted  = 100;
                }
                //</Mazikcare>
            }
            if (smmActivities.validateWrite(true))
            {
                smmActivities.update();
            }
            ttscommit;
    
            smmActivities.reread();
        }
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>