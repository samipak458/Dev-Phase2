<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>HMPatientPostSalesInvoiceService</Name>
	<SourceCode>
		<Declaration><![CDATA[
class HMPatientPostSalesInvoiceService
{
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>PostSalesInvoice</Name>
				<Source><![CDATA[
    public boolean PostSalesInvoice(str _salesOrderId)
    {
        SalesFormLetter_Invoice invoice;
        SalesTable salesTable;
        boolean update = false;
    
        try
        {
            salesTable = SalesTable::find(_salesOrderId);
    
            if (salesTable)
            {
                invoice = SalesFormLetter::construct(DocumentStatus::Invoice);
    
                ttsBegin;
    
                   invoice.update(salesTable,
                    DateTimeUtil::getSystemDate(DateTimeUtil::getUserPreferredTimeZone()),
                    SalesUpdate::All,
                    AccountOrder::None,
                    false,
                    false); // Set to true to print the invoice
    
                    update = true;
    
                ttsCommit;
            }
        }
        catch(Exception::Error)
        {
            update = false;
        }
    
        return update;
    
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>