<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>Job_scanDocument</Name>
	<SourceCode>
		<Declaration><![CDATA[
class Job_scanDocument  
{

}
]]></Declaration>
		<Methods>
			<Method>
				<Name>main</Name>
				<Source><![CDATA[
    static void main(Args _args)
{
    COM               commonDialog;
    COM               imageFile;
    str               wiaFormatJPEG     = "{B96B3CAE-0728-11D3-9D7B-0000F81EF32E}";
    str               wiaFormatBMP      = "{B96B3CAB-0728-11D3-9D7B-0000F81EF32E}";
    str               wiaFormatPNG      = "{B96B3CAF-0728-11D3-9D7B-0000F81EF32E}";
    str               wiaFormatGIF      = "{B96B3CB0-0728-11D3-9D7B-0000F81EF32E}";
    str               wiaFormatTIFF     = "{B96B3CB1-0728-11D3-9D7B-0000F81EF32E}";
    InteropPermission perm;
    ;

    // Set code access permission to help protect the use of the
    // COM object.
    perm = new InteropPermission(InteropKind::ComInterop);
    if (perm == null)
    {
        return;
    }
    // Permission scope starts here.
    perm.assert();

    commonDialog = new COM("WIA.CommonDialog");

    if (commonDialog != null)
    {
        imageFile = commonDialog.ShowAcquireImage(
                1,
                1,
                65536,
                wiaFormatJPEG,
                false,
                true,
                false);

        if (WinAPI::fileExists("C:\\AXtestb.jpg"))
        {
            info('file exist');
        }
        else
        {
            imageFile.SaveFile("C:\\AXtestb.jpg");
        }
    }

    // Close code access permission scope.
    CodeAccessPermission::revertAssert();
}

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>