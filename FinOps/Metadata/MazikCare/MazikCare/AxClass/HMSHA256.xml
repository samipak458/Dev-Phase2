<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>HMSHA256</Name>
	<SourceCode>
		<Declaration><![CDATA[
class HMSHA256
{
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>getHash</Name>
				<Source><![CDATA[
    public HMHashValue getHash(str _filePath)
    {
        System.Security.Cryptography.SHA256Managed sha = new System.Security.Cryptography.SHA256Managed();
        System.Byte[] hash;
        System.IO.FileStream inputFile;
        System.Text.StringBuilder sBuilder = new System.Text.StringBuilder();
        int i, hashLength;
    
        try
        {
            if(!WinAPI::fileExists(_filePath,false))
            {
                throw error("@MAZ4997");
            }
    
            if(WinAPI::fileLocked(_filePath))
            {
                throw error("@MAZ5009");
            }
    
            //open file stream
            inputFile = System.IO.File::OpenRead(_filePath);
    
            //generate hash
            hash = sha.ComputeHash(inputFile);
    
            //convert hash byte array to string
            // Loop through each byte of the hashed data and format each one as a hexadecimal string.
            hashLength = hash.get_Length();
            for (i = 0; i < hashLength; i++)
            {
                sBuilder.Append(System.String::Format('{0:x2}',hash.GetValue(i)));
            }
    
            //close input stream
            inputFile.Close();
    
            // Return the hexadecimal string.
            return sBuilder.ToString();
        }
        catch
        {
            try
            {
                if(inputFile != null)
                {
                    inputFile.Close();
                }
            }
            catch
            {
                throw error("@MAZ4998");
            }
    
    
    
            return '';
        }
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>