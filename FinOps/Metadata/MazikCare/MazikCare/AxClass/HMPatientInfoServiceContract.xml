<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>HMPatientInfoServiceContract</Name>
	<SourceCode>
		<Declaration><![CDATA[
class HMPatientInfoServiceContract
{
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>getPatientImage</Name>
				<Source><![CDATA[
    public System.Byte[] getPatientImage(str patientRecId)
    {
        RecId _patientRecID;
        //DocuRef documentRef;
        System.Byte[] byteArray;
        str name;
        _patientRecID = str2int64(patientRecId);
    
        //documentRef = DocuRef::findRecId(HMPatient::find(_patientRecId).DocuRef);
        //if(documentRef.recid > 0)
        //{
        //    name  = documentRef.completeFilename();
        //    if(System.IO.File::Exists(name))
        //    {
        //        byteArray = System.IO.File::ReadAllBytes(name);
        //        return byteArray;
        //    }
        //}
        return byteArray;
    }

]]></Source>
			</Method>
			<Method>
				<Name>getPatients</Name>
				<Source><![CDATA[
    [ AifCollectionTypeAttribute('return', Types::Class, classstr(HMPatientInfoContract))]
    public List getPatients(LastName _lastName)
    {
        HMPatientInfoContract hmPatientInfoContractObj;
        List _patientList = new List(Types::Class);
    
        HMPatient                           hmPatient;
        CustTable                           custTable;
        DirPartyTable                       dirPartyTable;
        DirPerson                           dirPerson;
        DirPersonName                       dirPersonName;
        //LogisticsLocation                   logisticsLocation;
        HMResourceSchedulingAppointment     hmResScheAppoint;
    
        while select * from hmPatient
            join custTable
            join * from dirPartyTable
            join dirPerson
            join dirPersonName
            //outer join hmResScheAppoint group by hmResScheAppoint.HMPatient
            //order by hmResScheAppoint.AppointmentDate, hmResScheAppoint.AppointmentTime desc
            where  dirPersonName.LastName like _lastName
                && hmPatient.CustTable == custTable.RecId
                //&& hmResScheAppoint.HMPatient == hmPatient.RecId
                && custTable.Party == dirPartyTable.RecId
                && dirPerson.RecId == dirPartyTable.RecId
                && dirPersonName.Person == dirPerson.RecId
    
    
        {
            select firstOnly  AppointmentStatus from hmResScheAppoint
            order by hmResScheAppoint.AppointmentDate desc
            where hmResScheAppoint.HMPatient == hmPatient.RecId;
    
            hmPatientInfoContractObj = new HMPatientInfoContract();
            hmPatientInfoContractObj.parmFirstName(dirPersonName.FirstName);
            hmPatientInfoContractObj.parmMiddleName(dirPersonName.MiddleName);
            hmPatientInfoContractObj.parmLastName(dirPersonName.LastName);
    
            hmPatientInfoContractObj.parmDateOfBirth(mkDate(dirPerson.BirthDay,dirPerson.BirthMonth,dirPerson.BirthYear));
            //hmPatientInfoContractObj.parmDateOfBirth(enum2str(dirPerson.BirthMonth) + ' ' + int2str(dirPerson.BirthDay) +', '+ int2str(dirPerson.BirthYear) );
    
            hmPatientInfoContractObj.parmMRN(custTable.AccountNum);
            hmPatientInfoContractObj.parmPatientRecid(int642str(hmPatient.RecId));
            hmPatientInfoContractObj.parmPatientImage(this.getPatientImage(int642str(hmPatient.RecId)));
            hmPatientInfoContractObj.parmPatientStatus(hmResScheAppoint.getAppointmentStatus());
    
            _patientList.addEnd(hmPatientInfoContractObj);
        }
        return _patientList;
    }

]]></Source>
			</Method>
			<Method>
				<Name>method1</Name>
				<Source><![CDATA[
    private void method1()
    {
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>