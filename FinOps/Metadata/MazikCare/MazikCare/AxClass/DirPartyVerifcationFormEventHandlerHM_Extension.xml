<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>DirPartyVerifcationFormEventHandlerHM_Extension</Name>
	<SourceCode>
		<Declaration><![CDATA[
[ExtensionOf(formStr(DirPartyVerification))]
final class DirPartyVerifcationFormEventHandlerHM_Extension
{
    public boolean isupdate;
  
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>OKButton_OnClicked</Name>
				<Source><![CDATA[
    /// <summary>
    ///
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    [FormControlEventHandler(formControlStr(DirPartyVerification, OKButton), FormControlEventType::Clicked)]
    public static void OKButton_OnClicked(FormControl sender, FormControlEventArgs e)
    {
        boolean         isupdate;
        HMPatient       hmPatientLocal;
        Args            args;
        MenuFunction    menuFunction;
        FormRun         formRun;
        formRun         FormrunLocal = sender.formRun() as formrun;
       
        
        
        if (sender.labelText() == "@SYS2245")
        {
            //<MazikCare>
            if (isConfigurationkeyEnabled(configurationKeyNum(MazikCare)))
            {

                hmPatientLocal = HMPatient::findByPerson(FormrunLocal.dataSource(formDataSourceStr(DirPartyVerification,DirPartyTable)).cursor().RecId, true);
                if(hmPatientLocal)
                {
                    if(hmPatientLocal.Status != PatientStatus::Active)
                    {
                        if(Box::yesNo(strFmt("@MAZ8980",hmPatientLocal.Status),DialogButton::Yes,"@MAZ7757") == DialogButton::Yes)
                        {
                            ttsBegin;
        
                            hmPatientLocal.Status = PatientStatus::Active;
                            hmPatientLocal.update();
        
                            ttsCommit;
        
                        }
                        isUpdate = true;
                    }
                    if(hmPatientLocal)
                    {
                        
                        args = new Args();
                        args.record(CustTable::findRecId(hmPatientLocal.CustTable));
                        args.caller(FormrunLocal);
        
                        menuFunction = new MenuFunction(menuitemdisplaystr(HMPatientChartRegistrationEdit), MenuItemType::Display);
                        formRun = menuFunction.create(args);
                        formRun.run();
                    }
                    //</MazikCare>
                    FormrunLocal.closeCancel();
                    

                }
        
            }
        }
        
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>