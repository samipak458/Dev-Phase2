<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>HMPatientClass</Name>
	<SourceCode>
		<Declaration><![CDATA[
class HMPatientClass
{
    RecId patientRecId;
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>markEncounterActive</Name>
				<Source><![CDATA[
    public boolean markEncounterActive()
    {
        HMPatient   hmPatient;
    
        ttsBegin;
    
        hmPatient = HMPatient::find(this.parmPatientRecId(),true);
        hmPatient.EncounterActive = NoYes::Yes;
    
        if (hmPatient.validateWrite())
        {
            hmPatient.update();
    
            ttsCommit;
            return true;
        }
        else
        {
            ttsAbort;
            return false;
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>markEncounterInActive</Name>
				<Source><![CDATA[
    public boolean markEncounterInActive()
    {
        HMPatient   hmPatient;
    
        ttsBegin;
    
        hmPatient = HMPatient::find(this.parmPatientRecId(),true);
        hmPatient.EncounterActive = NoYes::No;
    
        if (hmPatient.validateWrite())
        {
            hmPatient.update();
    
            ttsCommit;
            return true;
        }
        else
        {
            ttsAbort;
            return false;
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>parmPatientRecId</Name>
				<Source><![CDATA[
    public RecId parmPatientRecId(RecId _patientRecId = patientRecId)
    {
        patientRecId = _patientRecId;
        return patientRecId;
    }

]]></Source>
			</Method>
			<Method>
				<Name>construct</Name>
				<Source><![CDATA[
    public static HMPatientClass construct()
    {
        return new HMPatientClass();
    }

]]></Source>
			</Method>
			<Method>
				<Name>getPartyRecId</Name>
				<Source><![CDATA[
    public static RecId getPartyRecId(RecId _patientRecId)
    {
        CustTable custTable;
        HMPatient hmPatient;
    
        select firstOnly RecId from hmPatient where hmPatient.RecId == _patientRecId
        join party from custTable where custTable.RecId == hmPatient.CustTable;
    
        return custTable.Party;
    }

]]></Source>
			</Method>
			<Method>
				<Name>updateEmployeeNum</Name>
				<Source><![CDATA[
    public static boolean updateEmployeeNum(RecId _patientRecId, String10 _employeeNum)
    {
        HMPatient   hmPatient;
    
        try
        {
            ttsBegin;
    
            hmPatient = HMPatient::find(_patientRecId,true);
    
            if(hmPatient.EmployeeNumber != _employeeNum)
            {
                hmPatient.EmployeeNumber = _employeeNum;
    
                hmPatient.update();
    
                ttsCommit;
                return true;
            }
            else
            {
                ttsCommit;
                return true;
            }
        }
        catch
        {
            return false;
        }
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>