<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>HMSalesLineBuilder</Name>
	<SourceCode>
		<Declaration><![CDATA[
class HMSalesLineBuilder
{
    SalesTable salesTable;
    SalesLine salesLine;
    SalesTableForm salesTableForm;
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>insert</Name>
				<Source><![CDATA[
    public void insert()
    {
        salesLine.LineNum = SalesLine::lastLineNum(salesLine.SalesId) + 1.0;
    
        salesTableForm.salesLine_Write(salesLine);
        salesLine.insert();
    }

]]></Source>
			</Method>
			<Method>
				<Name>new</Name>
				<Source><![CDATA[
    public void new(SalesTable _salesTable)
    {
        salesTable = _salesTable;
    
        salesLine.initFromSalesTable(salesTable);
        salesLine.initValue();
    
        salesTableForm = new SalesTableForm(salesTable);
    }

]]></Source>
			</Method>
			<Method>
				<Name>salesLine</Name>
				<Source><![CDATA[
    public SalesLine salesLine()
    {
        return salesLine;
    }

]]></Source>
			</Method>
			<Method>
				<Name>setAllFields</Name>
				<Source><![CDATA[
    public void setAllFields(ItemId _itemId,
                                SalesQty _salesQty,
                                DimensionDefault _dimensionDefault,
                                TaxItemGroup _taxItemGroup,
                                TaxGroup _taxGroup,
                                ItemId _protocolId,
                                RecId _hcmWorkerRecId,
                                VendAccount _vendorDoctorAccount,
                                HMAppointmentNumber _appointmentNumber,
                                str _drugReference,
                                InventDimId _inventDimId,
                                SalesPrice _salesPrice)
    {
        salesLine.ItemId = _itemId;
        //salesLine.modifiedField(fieldNum(SalesLine, ItemId));
    
        // I'd rather not have this line but this logic is on the form
        //salesLine.itemIdChanged(salesTable.MatchingAgreement != 0, salesTable.MatchingAgreement);
        //salesLine.modifyInventDim(InventDim::find(salesLine.InventDimId), fieldNum(InventDim,InventLocationId), false);
        //InventMovement::bufferSetTransQtyUnit(salesLine);
    
        salesLine.SalesQty = _salesQty;
        //salesLine.modifiedField(fieldNum(SalesLine, SalesQty));
        //salesLine.LineAmount = salesLine.calcLineAmount();
    
        SalesLine.DefaultDimension = _dimensionDefault;
        //salesLine.modifiedField(fieldNum(SalesLine, DefaultDimension));
    
        SalesLine.TaxItemGroup = _taxItemGroup;
        //salesLine.modifiedField(fieldNum(SalesLine, TaxItemGroup));
    
        SalesLine.TaxGroup = _taxGroup;
        //salesLine.modifiedField(fieldNum(SalesLine, TaxGroup));
    
        SalesLine.ProtocolId = _protocolId;
        //salesLine.modifiedField(fieldNum(SalesLine, ProtocolId));
    
        SalesLine.HcmWorker = _hcmWorkerRecId;
        //salesLine.modifiedField(fieldNum(SalesLine, HcmWorker));
    
        SalesLine.VendorDoctorAccount = _vendorDoctorAccount;
        //salesLine.modifiedField(fieldNum(SalesLine, VendorDoctorAccount));
    
        SalesLine.DrugReference = _drugReference;
        //salesLine.modifiedField(fieldNum(SalesLine, DrugReference));
    
        SalesLine.InventDimId = _inventDimId;
        salesLine.modifiedField(fieldNum(SalesLine, InventDimId));
        salesLine.itemIdChanged(salesTable.MatchingAgreement != 0, salesTable.MatchingAgreement);
        InventMovement::bufferSetTransQtyUnit(salesLine);
    
        salesLine.SalesPrice = _salesPrice;
        salesLine.modifiedField(fieldNum(SalesLine, SalesPrice));
        salesLine.LineAmount = salesLine.calcLineAmount();
    
        salesLine.HMAppointmentNumber = _appointmentNumber;
    }

]]></Source>
			</Method>
			<Method>
				<Name>setAppointmentNumber</Name>
				<Source><![CDATA[
    public void setAppointmentNumber(HMAppointmentNumber _appointmentNumber)
    {
        salesLine.HMAppointmentNumber = _appointmentNumber;
    }

]]></Source>
			</Method>
			<Method>
				<Name>setDimensionAccount</Name>
				<Source><![CDATA[
    public void setDimensionAccount(DimensionDefault _dimensionDefault)
    {
        SalesLine.DefaultDimension = _dimensionDefault;
        salesLine.modifiedField(fieldNum(SalesLine, DefaultDimension));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setDrugReference</Name>
				<Source><![CDATA[
    public void setDrugReference(str _drugReference)
    {
        SalesLine.DrugReference = _drugReference;
        salesLine.modifiedField(fieldNum(SalesLine, DrugReference));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setInventDim</Name>
				<Source><![CDATA[
    public void setInventDim(InventDimId _inventDimId)
    {
        SalesLine.InventDimId = _inventDimId;
        salesLine.modifiedField(fieldNum(SalesLine, InventDimId));
        salesLine.itemIdChanged(salesTable.MatchingAgreement != 0, salesTable.MatchingAgreement);
        InventMovement::bufferSetTransQtyUnit(salesLine);
    }

]]></Source>
			</Method>
			<Method>
				<Name>setItemId</Name>
				<Source><![CDATA[
    public void setItemId(ItemId _itemId)
    {
        salesLine.ItemId = _itemId;
        salesLine.modifiedField(fieldNum(SalesLine, ItemId));
    
        // I'd rather not have this line but this logic is on the form
        salesLine.itemIdChanged(salesTable.MatchingAgreement != 0, salesTable.MatchingAgreement);
        salesLine.modifyInventDim(InventDim::find(salesLine.InventDimId), fieldNum(InventDim,InventLocationId), false);
        InventMovement::bufferSetTransQtyUnit(salesLine);
    }

]]></Source>
			</Method>
			<Method>
				<Name>setLineAmount</Name>
				<Source><![CDATA[
    public void setLineAmount(SalesLineAmount _lineAmount)
    {
        salesLine.LineAmount = _lineAmount;
        salesLine.modifiedField(fieldNum(SalesLine, LineAmount));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setLineDiscount</Name>
				<Source><![CDATA[
    public void setLineDiscount(AmountMST _discount)
    {
        SalesLine.LineDisc = _discount;
        salesLine.modifiedField(fieldNum(SalesLine, LineDisc));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setProtocolId</Name>
				<Source><![CDATA[
    public void setProtocolId(ItemId _protocolId)
    {
        SalesLine.ProtocolId = _protocolId;
        salesLine.modifiedField(fieldNum(SalesLine, ProtocolId));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setSalesPrice</Name>
				<Source><![CDATA[
    public void setSalesPrice(SalesPrice _salesPrice)
    {
        salesLine.SalesPrice = _salesPrice;
        salesLine.modifiedField(fieldNum(SalesLine, SalesPrice));
        salesLine.LineAmount = salesLine.calcLineAmount();
    }

]]></Source>
			</Method>
			<Method>
				<Name>setSalesQty</Name>
				<Source><![CDATA[
    public void setSalesQty(SalesQty _salesQty)
    {
        salesLine.SalesQty = _salesQty;
        salesLine.modifiedField(fieldNum(SalesLine, SalesQty));
        salesLine.LineAmount = salesLine.calcLineAmount();
    }

]]></Source>
			</Method>
			<Method>
				<Name>setTaxGroup</Name>
				<Source><![CDATA[
    public void setTaxGroup(TaxGroup _taxGroup)
    {
        SalesLine.TaxGroup = _taxGroup;
        salesLine.modifiedField(fieldNum(SalesLine, TaxGroup));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setTaxItemGroup</Name>
				<Source><![CDATA[
    public void setTaxItemGroup(TaxItemGroup _taxItemGroup)
    {
        SalesLine.TaxItemGroup = _taxItemGroup;
        salesLine.modifiedField(fieldNum(SalesLine, TaxItemGroup));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setVendAccount</Name>
				<Source><![CDATA[
    public void setVendAccount(VendAccount _vendorDoctorAccount)
    {
        SalesLine.VendorDoctorAccount = _vendorDoctorAccount;
        salesLine.modifiedField(fieldNum(SalesLine, VendorDoctorAccount));
    }

]]></Source>
			</Method>
			<Method>
				<Name>setWorkerRecId</Name>
				<Source><![CDATA[
    public void setWorkerRecId(RecId _hcmWorkerRecId)
    {
        SalesLine.HcmWorker = _hcmWorkerRecId;
        salesLine.modifiedField(fieldNum(SalesLine, HcmWorker));
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>