<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>HMTreeSearching</Name>
	<SourceCode>
		<Declaration><![CDATA[
class HMTreeSearching
{
    HMTreeSearchingTmp  hmTreeSearchingTmp;
    String255 lastData;
    String255 lastDescription;
    int ocurrence;
}
]]></Declaration>
		<Methods>
			<Method>
				<Name>getHMTreeSearchingTmp</Name>
				<Source><![CDATA[
    public HMTreeSearchingTmp getHMTreeSearchingTmp()
    {
        return  hmTreeSearchingTmp;
    }

]]></Source>
			</Method>
			<Method>
				<Name>getItemIdx</Name>
				<Source><![CDATA[
    public TreeItemIdx getItemIdx(String255 _description)
    {
        select firstOnly hmTreeSearchingTmp
            order by recId
            where hmTreeSearchingTmp.Description like "*"+_description+"*";
    
        return hmTreeSearchingTmp.ItemIdx;
    }

]]></Source>
			</Method>
			<Method>
				<Name>getItemIdxByData</Name>
				<Source><![CDATA[
    public TreeItemIdx getItemIdxByData(String255 _data)
    {
        select hmTreeSearchingTmp
            order by recId
            where hmTreeSearchingTmp.Data == _data;
    
        return hmTreeSearchingTmp.ItemIdx;
    }

]]></Source>
			</Method>
			<Method>
				<Name>increaseOccurence</Name>
				<Source><![CDATA[
    private void increaseOccurence()
    {
        ocurrence++;
    }

]]></Source>
			</Method>
			<Method>
				<Name>insertItem</Name>
				<Source><![CDATA[
    public void insertItem(TreeItemIdx _itemIdx, String255 _description = "", String255 _data = "")
    {
        hmTreeSearchingTmp.ItemIdx = _itemIdx;
        hmTreeSearchingTmp.Description = _description;
        hmTreeSearchingTmp.Data = _data;
        hmTreeSearchingTmp.insert();
    }

]]></Source>
			</Method>
			<Method>
				<Name>new</Name>
				<Source><![CDATA[
    public void new()
    {
        lastData = "";
        lastDescription = "";
        ocurrence = 0;
    }

]]></Source>
			</Method>
			<Method>
				<Name>parmLastData</Name>
				<Source><![CDATA[
    public String255 parmLastData(String255 _lastData = lastData)
    {
        lastData = _lastData;
        return lastData;
    }

]]></Source>
			</Method>
			<Method>
				<Name>parmLastDescription</Name>
				<Source><![CDATA[
    public String255 parmLastDescription(String255 _lastDescription = lastDescription)
    {
        lastDescription = _lastDescription;
        return lastDescription;
    }

]]></Source>
			</Method>
			<Method>
				<Name>parmOccurence</Name>
				<Source><![CDATA[
    public int parmOccurence(int _occurence = ocurrence)
    {
        ocurrence = _occurence;
        return ocurrence;
    }

]]></Source>
			</Method>
			<Method>
				<Name>resetOcurrence</Name>
				<Source><![CDATA[
    private void resetOcurrence()
    {
        ocurrence = 0;
    }

]]></Source>
			</Method>
			<Method>
				<Name>searchByData</Name>
				<Source><![CDATA[
    public TreeItemIdx searchByData(String255 _data)
    {
        int i=0;
        boolean isFound = true;
        DialogButton btnDlg;
    
        if(_data == this.parmLastData())
        {
            select hmTreeSearchingTmp
                order by recId
                where hmTreeSearchingTmp.Data == _data;
    
            for(i=0;i < this.parmOccurence();i++)
            {
                next hmTreeSearchingTmp;
    
                if(!hmTreeSearchingTmp)
                {
                    btnDlg = Box::yesNo("@MAZ3828", DialogButton::No);
    
                    if(btnDlg == DialogButton::Yes)
                    {
                        this.resetOcurrence();
    
                        select firstOnly hmTreeSearchingTmp
                            order by recId
                            where hmTreeSearchingTmp.Data == _data;
    
                    }
                    else
                    {
                        isFound = false;
                    }
                    break;
                }
            }
            if(isFound)
            {
                this.increaseOccurence();
            }
        }
        else
        {
            this.resetOcurrence();
    
            select firstOnly hmTreeSearchingTmp
                order by recId
                where hmTreeSearchingTmp.Data == _data;
    
            if(hmTreeSearchingTmp)
            {
                this.increaseOccurence();
                this.parmLastData(_data);
            }
            else
            {
                this.parmLastData("");
                Box::info("@MAZ3827");
            }
        }
    
        return hmTreeSearchingTmp.ItemIdx;
    }

]]></Source>
			</Method>
			<Method>
				<Name>searchByDescription</Name>
				<Source><![CDATA[
    public TreeItemIdx searchByDescription(String255 _description)
    {
        int i=0;
        boolean isFound = true;
        DialogButton btnDlg;
    
        if(_description == this.parmLastDescription())
        {
            select hmTreeSearchingTmp
                order by recId
                where hmTreeSearchingTmp.Description like '*'+_description+'*';
    
            for(i=0;i < this.parmOccurence();i++)
            {
                next hmTreeSearchingTmp;
    
                if(!hmTreeSearchingTmp)
                {
                    btnDlg = Box::yesNo("@MAZ3828", DialogButton::No);
    
                    if(btnDlg == DialogButton::Yes)
                    {
                        this.resetOcurrence();
    
                        select firstOnly hmTreeSearchingTmp
                            order by recId
                            where hmTreeSearchingTmp.Description like '*'+_description+'*';
    
                    }
                    else
                    {
                        isFound = false;
                    }
                    break;
                }
            }
            if(isFound)
            {
                this.increaseOccurence();
            }
        }
        else
        {
            this.resetOcurrence();
    
            select firstOnly hmTreeSearchingTmp
                order by recId
                where hmTreeSearchingTmp.Description like '*'+_description+'*';
    
            if(hmTreeSearchingTmp)
            {
                this.increaseOccurence();
                this.parmLastDescription(_description);
            }
            else
            {
                this.parmLastDescription('');
                Box::info("@MAZ3827");
            }
        }
    
        return hmTreeSearchingTmp.ItemIdx;
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>