<?xml version="1.0" encoding="utf-8"?>
<AxForm xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="Microsoft.Dynamics.AX.Metadata.V6">
	<Name>HMServiceCategoryDialog</Name>
	<SourceCode>
		<Methods xmlns="">
			<Method>
				<Name>classDeclaration</Name>
				<Source><![CDATA[
/* TODO: (Code Upgrade) Removed unused footnote group. */
/* TODO: (Code Upgrade) Two conflicting captions were defined on this form. The StaticText caption previously on the form was removed, and contained the following label: @MAZ9014. Ensure the value in formDesign.Caption contains the caption you want for this form. */
[Form]
public class HMServiceCategoryDialog extends FormRun
{

     EcoResCategoryHierarchy             selectedHierarchy;
     EcoResCategoryHierarchy             mCategoryHierarchy;
     EcoResCategoryTreeDatasourceHM        mHierarchyTree;
     EcoResCategoryHierarchy             currentSalesCategoryHierarchy;
     dataAreaId                          selectedDataArea;
     CompanyInfo                         selectedLegalEntity;
     recId                               oraganizationalUnitRecId;
     Object                                  formRunObject;
     FormRun                                 formRun;
     NoYes                                   isOkClicked;

}
]]></Source>
			</Method>
			<Method>
				<Name>init</Name>
				<Source><![CDATA[
    public void init()
    {
        oraganizationalUnitRecId = element.args().record().RecId;
        super();
        currentSalesCategoryHierarchy =  EcoResCategoryHierarchy::find(EcoResCategoryHierarchyRole::getHierarchiesByRole(EcoResCategoryNamedHierarchyRole::Sales).CategoryHierarchy);
    
        if (currentSalesCategoryHierarchy && currentSalesCategoryHierarchy.RecId)
        {
            element.initializeHelper();
        }
    
        selectedDataArea     = curext();
        selectedLegalEntity  = CompanyInfo::findDataArea(curext());
    
    }

]]></Source>
			</Method>
			<Method>
				<Name>initializeHelper</Name>
				<Source><![CDATA[
    public void initializeHelper()
    {
    
        EcoResCategory          root;
        EcoResCategoryLookupParameters lookupParameters = new EcoResCategoryLookupParameters(false, false, false);
    
        root = EcoResCategory::getRoot(currentSalesCategoryHierarchy.RecId);
        if (!root)
        {
            throw Global::error("@SYS134281");
        }
    
    
    
        mHierarchyTree = new EcoResCategoryTreeDatasourceHM(  ecoResCategory_ds,
                                                           categoryTreeCtrl,
                                                           fieldNum(EcoResCategory, RecId),
                                                           fieldNum(EcoResCategory, ParentCategory),
                                                           fieldNum(EcoResCategory, Name),
                                                           false,
                                                           true,
                                                           fieldNum(EcoResCategory, Code),
                                                           currentSalesCategoryHierarchy,
                                                           null,
                                                           lookupParameters);
    
        mHierarchyTree.initRoot(root.Name, root.RecId, mHierarchyTree.image(root) );
    }

]]></Source>
			</Method>
		</Methods>
		<DataSources xmlns="">
			<DataSource>
				<Name>EcoResCategory</Name>
				<Methods>
					<Method>
						<Name>prev</Name>
						<Source><![CDATA[
        public int prev()
        {
            int ret;
        
            ret = mHierarchyTree.prev();
        
            return ret;
        }

]]></Source>
					</Method>
					<Method>
						<Name>next</Name>
						<Source><![CDATA[
        public int next()
        {
            int ret;
        
            ret = mHierarchyTree.next();
        
            return ret;
        }

]]></Source>
					</Method>
					<Method>
						<Name>last</Name>
						<Source><![CDATA[
        public int last()
        {
            int ret;
        
            ret = mHierarchyTree.last();
        
            return ret;
        }

]]></Source>
					</Method>
					<Method>
						<Name>first</Name>
						<Source><![CDATA[
        public int first()
        {
            int ret;
        
            ret = mHierarchyTree.first();
        
            return ret;
        }

]]></Source>
					</Method>
				</Methods>
				<Fields />
			</DataSource>
		</DataSources>
		<DataControls xmlns="">
			<Control>
				<Name>categoryTreeCtrl</Name>
				<Type>Tree</Type>
				<Methods>
					<Method>
						<Name>expanded</Name>
						<Source><![CDATA[
        public void expanded(int _Idx, FormTreeExpand _action, anytype _data)
        {
             super(_idx, _action, _data);
        
            if ((FormTreeExpand::Expand == _action) && mHierarchyTree)
            {
                mHierarchyTree.updateTree(_idx);
            }
        }

]]></Source>
					</Method>
					<Method>
						<Name>expanding</Name>
						<Source><![CDATA[
        //
        public boolean expanding(int _Idx, FormTreeExpand _action, anytype _data)
        {
            boolean ret;
        
            ret = super(_idx, _action, _data);
        
            if (mHierarchyTree)
            {
                mHierarchyTree.expanding(_idx, _action, _data);
            }
        
            return ret;
        }

]]></Source>
					</Method>
					<Method>
						<Name>keyDown</Name>
						<Source><![CDATA[
        public boolean keyDown(int _vKey, boolean _Ctrl, boolean _Shift)
        {
            boolean ret;
        
            ret = super(_vKey, _Ctrl, _Shift);
        
            return ret;
        }

]]></Source>
					</Method>
					<Method>
						<Name>selectionChanged</Name>
						<Source><![CDATA[
        public void selectionChanged(FormTreeItem _OldItem, FormTreeItem _NewItem, FormTreeSelect _how)
        {
             int root = this.getRoot();
        
            super(_oldItem, _newItem, _how);
        
            if (mHierarchyTree)
            {
                mHierarchyTree.selectionChanged(_oldItem, _newItem);
            }
        
        }

]]></Source>
					</Method>
					<Method>
						<Name>selectionChanging</Name>
						<Source><![CDATA[
        public boolean selectionChanging(FormTreeItem _OldItem, FormTreeItem _NewItem, FormTreeSelect _how)
        {
            boolean ret;
        
            ret = super(_oldItem, _newItem, _how);
        
            if (!ret && mHierarchyTree)
            {
                ret = mHierarchyTree.selectionChanging(_oldItem, _newItem, _how);
            }
        
            return ret;
        }

]]></Source>
					</Method>
				</Methods>
			</Control>
			<Control>
				<Name>OKButton</Name>
				<Type>CommandButton</Type>
				<Methods>
					<Method>
						<Name>clicked</Name>
						<Source><![CDATA[
        void clicked()
        {
            HMOrganizationServiceCategory    HMOrganizationServiceCategoryLocal;
            FormTreeItem                    selectedTreeItem = categoryTreeCtrl.getItem(categoryTreeCtrl.getSelection());
            select HMOrganizationServiceCategoryLocal;
        
                HMOrganizationServiceCategoryLocal.HMOrganizationalUnit = oraganizationalUnitRecId;
                HMOrganizationServiceCategoryLocal.EcoResCategory = selectedTreeItem.data();
                if(HMOrganizationServiceCategoryLocal.validateWrite())
                {
                    HMOrganizationServiceCategoryLocal.insert();
                    formRun = element.args().caller();
        
                    if (formHasMethod(formRun, identifierstr(refreshServiceCategory)))
                    {
                        formRunObject = formRun;
                        formRunObject.refreshServiceCategory();
                    }
                    super();
                    element.close();
                }
        
        }

]]></Source>
					</Method>
				</Methods>
			</Control>
		</DataControls>
		<Members xmlns="" />
	</SourceCode>
	<DataSources>
		<AxFormDataSource xmlns="">
			<Name>EcoResCategory</Name>
			<Table>EcoResCategory</Table>
			<Fields>
				<AxFormDataSourceField>
					<DataField>CategoryHierarchy</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ChangeStatus</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Code</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>createdBy</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>createdDateTime</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>dataAreaId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DefaultProjectGlobalCategory</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>DefaultThreshold_PSN</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>HMCategoryType</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>InstanceRelationType</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IsActive</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IsCategoryAttributesInherited</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>IsTangible</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Level</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>modifiedBy</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>modifiedDateTime</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>Name</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>NestedSetLeft</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>NestedSetRight</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>ParentCategory</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>PKWiUCode</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>RecId</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>relationType</DataField>
				</AxFormDataSourceField>
				<AxFormDataSourceField>
					<DataField>TableId</DataField>
				</AxFormDataSourceField>
			</Fields>
			<ReferencedDataSources />
			<InsertIfEmpty>No</InsertIfEmpty>
			<DataSourceLinks />
			<DerivedDataSources>
				<AxFormDataSourceDerived>
					<Name>EcoResCategory_PCClass</Name>
					<Table>PCClass</Table>
					<Fields>
						<AxFormDataSourceField>
							<DataField>RecId</DataField>
						</AxFormDataSourceField>
						<AxFormDataSourceField>
							<DataField>ReuseEnabled</DataField>
						</AxFormDataSourceField>
						<AxFormDataSourceField>
							<DataField>TableId</DataField>
						</AxFormDataSourceField>
					</Fields>
					<ReferencedDataSources />
					<DerivedDataSources />
				</AxFormDataSourceDerived>
			</DerivedDataSources>
		</AxFormDataSource>
	</DataSources>
	<Design>
		<BackgroundColor xmlns="">WindowBackground</BackgroundColor>
		<Caption xmlns="">@MAZ9014</Caption>
		<DialogSize xmlns="">Medium</DialogSize>
		<Frame xmlns="">Dialog</Frame>
		<HideToolbar xmlns="">Yes</HideToolbar>
		<Pattern xmlns="">DropDialog</Pattern>
		<PatternVersion xmlns="">1.2</PatternVersion>
		<Scrollbars xmlns="">No</Scrollbars>
		<StatusBarStyle xmlns="">None</StatusBarStyle>
		<Style xmlns="">DropDialog</Style>
		<Width xmlns="">300</Width>
		<WindowType xmlns="">Popup</WindowType>
		<Controls xmlns="">
			<AxFormControl xmlns=""
				i:type="AxFormStaticTextControl">
				<Name>SupplementalInstruction</Name>
				<ElementPosition>1610612733</ElementPosition>
				<ExtendedStyle>dialog_secondaryInstruction</ExtendedStyle>
				<FilterExpression>%1</FilterExpression>
				<Type>StaticText</Type>
				<VerticalSpacing>-1</VerticalSpacing>
				<WidthMode>SizeToAvailable</WidthMode>
				<FormControlExtension
					i:nil="true" />
				<DisplayHeight>2</DisplayHeight>
				<DisplayHeightMode>Fixed</DisplayHeightMode>
				<DisplayLength>80</DisplayLength>
				<DisplayLengthMode>Fixed</DisplayLengthMode>
				<Text></Text>
			</AxFormControl>
			<AxFormControl xmlns=""
				i:type="AxFormGroupControl">
				<Name>DialogContent</Name>
				<ElementPosition>715827882</ElementPosition>
				<FilterExpression>%1</FilterExpression>
				<Pattern>ToolbarList</Pattern>
				<PatternVersion>1.2</PatternVersion>
				<Type>Group</Type>
				<VerticalSpacing>-1</VerticalSpacing>
				<WidthMode>SizeToAvailable</WidthMode>
				<FormControlExtension
					i:nil="true" />
				<Controls>
					<AxFormControl xmlns=""
						i:type="AxFormTreeControl">
						<Name>categoryTreeCtrl</Name>
						<AutoDeclaration>Yes</AutoDeclaration>
						<ElementPosition>1207959549</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>SizeToAvailable</HeightMode>
						<Left>10</Left>
						<LeftMode>Manual</LeftMode>
						<Type>Tree</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<FormControlExtension
							i:nil="true" />
					</AxFormControl>
				</Controls>
				<Style>DialogContent</Style>
			</AxFormControl>
			<AxFormControl xmlns=""
				i:type="AxFormButtonGroupControl">
				<Name>ButtonGroup</Name>
				<ElementPosition>1073741822</ElementPosition>
				<FilterExpression>%1</FilterExpression>
				<Type>ButtonGroup</Type>
				<VerticalSpacing>-1</VerticalSpacing>
				<WidthMode>SizeToAvailable</WidthMode>
				<FormControlExtension
					i:nil="true" />
				<Controls>
					<AxFormControl xmlns=""
						i:type="AxFormCommandButtonControl">
						<Name>OKButton</Name>
						<ElementPosition>1431655764</ElementPosition>
						<FilterExpression>%1</FilterExpression>
						<HeightMode>Auto</HeightMode>
						<Skip>Yes</Skip>
						<Type>CommandButton</Type>
						<VerticalSpacing>-1</VerticalSpacing>
						<WidthMode>Auto</WidthMode>
						<FormControlExtension
							i:nil="true" />
						<Command>OK</Command>
						<DefaultButton>Yes</DefaultButton>
					</AxFormControl>
				</Controls>
				<ArrangeMethod>HorizontalRight</ArrangeMethod>
				<Style>DialogCommitContainer</Style>
			</AxFormControl>
		</Controls>
	</Design>
	<Parts />
</AxForm>